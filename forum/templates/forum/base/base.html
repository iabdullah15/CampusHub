{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token }}">
    {% block title %}
    <title>Document</title>
    {% endblock %}

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    
    
    <script src="https://kit.fontawesome.com/8992edd612.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static 'forum/css/base/navbar.css' %}">
    {% block fonts %}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <!-- Jquery -->
    <script
    src="https://code.jquery.com/jquery-3.7.1.js"
    integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
    crossorigin="anonymous"></script>
    <style>
      .notification-item.read {
        background-color: #f8f9fa; /* Light grey background for read notifications */
        color: #6c757d; /* Muted text color */
      }
      
    </style>
    
    {% endblock %}
    
    {% block css %}

    {% endblock %}

    {% block js %}
    {% endblock %}
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const notificationItems = document.querySelectorAll(".notification-item");
    
        notificationItems.forEach((item) => {
            item.addEventListener("click", function () {
                const notificationId = item.getAttribute("data-notification-id");
    
                if (notificationId) {
                    fetch(`/notifications/mark-read/${notificationId}/`, {
                        method: "POST",
                        headers: {
                            "X-CSRFToken": document.querySelector("[name=csrfmiddlewaretoken]").value,
                        },
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                // Mark the notification as read visually
                                item.classList.add("read");
    
                                // Update the notification badge count
                                const badge = document.querySelector(".notification-badge");
                                if (badge) {
                                    let count = parseInt(badge.textContent, 10);
                                    if (count > 0) {
                                        badge.textContent = count - 1;
                                        if (count - 1 === 0) {
                                            badge.remove(); // Remove badge if no unread notifications
                                        }
                                    }
                                }
                            } else {
                                console.error(data.error);
                            }
                        })
                        .catch((error) => console.error("Error:", error));
                }
            });
        });
    });
    
    </script>
    <link rel="stylesheet" href="{% static 'forum/css/color-palette/colors.css' %}">
</head>
<body>
  {% include 'forum/base/_header.html' %}

    {% block main %}


    {% endblock %}

</body>
</html>
